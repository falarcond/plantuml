<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="1232px" preserveAspectRatio="none" style="width:785px;height:1232px;" version="1.1" viewBox="0 0 785 1232" width="785px" zoomAndPan="magnify"><defs><filter height="300%" id="f16bhw1wh3arux" width="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="2.0"/><feColorMatrix in="blurOut" result="blurOut2" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"/><feOffset dx="4.0" dy="4.0" in="blurOut2" result="blurOut3"/><feBlend in="SourceGraphic" in2="blurOut3" mode="normal"/></filter></defs><g><rect fill="#FFFFFF" filter="url(#f16bhw1wh3arux)" height="311.0703" style="stroke: #000000; stroke-width: 2.0;" width="647" x="13" y="466.0234"/><rect fill="#FFFFFF" filter="url(#f16bhw1wh3arux)" height="105.3359" style="stroke: #000000; stroke-width: 2.0;" width="524" x="23" y="576.5547"/><rect fill="#FFFFFF" height="59.0703" style="stroke: none; stroke-width: 1.0;" width="524" x="23" y="622.8203"/><rect fill="#FFFFFF" height="88.2031" style="stroke: none; stroke-width: 1.0;" width="647" x="13" y="688.8906"/><rect fill="#FFFFFF" filter="url(#f16bhw1wh3arux)" height="163.6016" style="stroke: #000000; stroke-width: 2.0;" width="524" x="23" y="863.3594"/><rect fill="#FFFFFF" height="73.0703" style="stroke: none; stroke-width: 1.0;" width="524" x="23" y="953.8906"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="55" x2="55" y1="86.2969" y2="1145.3594"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="202.5" x2="202.5" y1="86.2969" y2="1145.3594"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="470" x2="470" y1="86.2969" y2="1145.3594"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="604" x2="604" y1="86.2969" y2="1145.3594"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="39" x="33" y="82.9951">Client</text><ellipse cx="55.5" cy="13" fill="#FEFECE" filter="url(#f16bhw1wh3arux)" rx="8" ry="8" style="stroke: #A80036; stroke-width: 2.0;"/><path d="M55.5,21 L55.5,48 M42.5,29 L68.5,29 M55.5,48 L42.5,63 M55.5,48 L68.5,63 " fill="none" filter="url(#f16bhw1wh3arux)" style="stroke: #A80036; stroke-width: 2.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="39" x="33" y="1157.3545">Client</text><ellipse cx="55.5" cy="1170.6563" fill="#FEFECE" filter="url(#f16bhw1wh3arux)" rx="8" ry="8" style="stroke: #A80036; stroke-width: 2.0;"/><path d="M55.5,1178.6563 L55.5,1205.6563 M42.5,1186.6563 L68.5,1186.6563 M55.5,1205.6563 L42.5,1220.6563 M55.5,1205.6563 L68.5,1220.6563 " fill="none" filter="url(#f16bhw1wh3arux)" style="stroke: #A80036; stroke-width: 2.0;"/><rect fill="#FEFECE" filter="url(#f16bhw1wh3arux)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="94" x="153.5" y="51"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="80" x="160.5" y="70.9951">Auth Server</text><rect fill="#FEFECE" filter="url(#f16bhw1wh3arux)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="94" x="153.5" y="1144.3594"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="80" x="160.5" y="1164.3545">Auth Server</text><rect fill="#FEFECE" filter="url(#f16bhw1wh3arux)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="129" x="404" y="51"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="115" x="411" y="70.9951">Resource Server</text><rect fill="#FEFECE" filter="url(#f16bhw1wh3arux)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="129" x="404" y="1144.3594"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="115" x="411" y="1164.3545">Resource Server</text><rect fill="#FEFECE" filter="url(#f16bhw1wh3arux)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="87" x="559" y="51"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="73" x="566" y="70.9951">JWT Library</text><rect fill="#FEFECE" filter="url(#f16bhw1wh3arux)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="87" x="559" y="1144.3594"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="73" x="566" y="1164.3545">JWT Library</text><polygon fill="#A80036" points="190.5,128.5625,200.5,132.5625,190.5,136.5625,194.5,132.5625" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="55.5" x2="196.5" y1="132.5625" y2="132.5625"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="123" x="62.5" y="112.3638">POST /authenticate</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="80" x="62.5" y="127.4966">(credentials)</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="202.5" x2="244.5" y1="161.6953" y2="161.6953"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="244.5" x2="244.5" y1="161.6953" y2="174.6953"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="203.5" x2="244.5" y1="174.6953" y2="174.6953"/><polygon fill="#A80036" points="213.5,170.6953,203.5,174.6953,213.5,178.6953,209.5,174.6953" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="126" x="209.5" y="156.6294">Validate credentials</text><polygon fill="#A80036" points="592.5,214.9609,602.5,218.9609,592.5,222.9609,596.5,218.9609" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="202.5" x2="598.5" y1="218.9609" y2="218.9609"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="85" x="209.5" y="198.7622">Generate JWT</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="161" x="209.5" y="213.895">(header, payload, secret)</text><polygon fill="#A80036" points="213.5,244.0938,203.5,248.0938,213.5,252.0938,209.5,248.0938" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="207.5" x2="603.5" y1="248.0938" y2="248.0938"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="61" x="219.5" y="243.0278">JWT token</text><polygon fill="#A80036" points="66.5,273.2266,56.5,277.2266,66.5,281.2266,62.5,277.2266" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="60.5" x2="201.5" y1="277.2266" y2="277.2266"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="116" x="72.5" y="272.1606">Response with JWT</text><rect fill="#EEEEEE" filter="url(#f16bhw1wh3arux)" height="3" style="stroke: #EEEEEE; stroke-width: 1.0;" width="770.5" x="3" y="305.793"/><line style="stroke: #000000; stroke-width: 1.0;" x1="3" x2="773.5" y1="305.793" y2="305.793"/><line style="stroke: #000000; stroke-width: 1.0;" x1="3" x2="773.5" y1="308.793" y2="308.793"/><rect fill="#EEEEEE" filter="url(#f16bhw1wh3arux)" height="23.1328" style="stroke: #000000; stroke-width: 2.0;" width="260" x="258.25" y="295.2266"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="241" x="264.25" y="311.2935">Token Validation on API Request</text><polygon fill="#A80036" points="458.5,360.625,468.5,364.625,458.5,368.625,462.5,364.625" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="55.5" x2="464.5" y1="364.625" y2="364.625"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="156" x="62.5" y="344.4263">GET /protected-resource</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="183" x="62.5" y="359.5591">Authorization: Bearer &lt;JWT&gt;</text><polygon fill="#A80036" points="592.5,389.7578,602.5,393.7578,592.5,397.7578,596.5,393.7578" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="470.5" x2="598.5" y1="393.7578" y2="393.7578"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="74" x="477.5" y="388.6919">Decode JWT</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="604.5" x2="646.5" y1="438.0234" y2="438.0234"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="646.5" x2="646.5" y1="438.0234" y2="451.0234"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="605.5" x2="646.5" y1="451.0234" y2="451.0234"/><polygon fill="#A80036" points="615.5,447.0234,605.5,451.0234,615.5,455.0234,611.5,451.0234" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="100" x="611.5" y="417.8247">Verify signature</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="155" x="611.5" y="432.9575">(using secret/public key)</text><path d="M13,466.0234 L77,466.0234 L77,473.0234 L67,483.0234 L13,483.0234 L13,466.0234 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 1.0;"/><rect fill="none" height="311.0703" style="stroke: #000000; stroke-width: 2.0;" width="647" x="13" y="466.0234"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="19" x="28" y="479.0903">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="107" x="92" y="478.2339">[Signature valid]</text><polygon fill="#A80036" points="481.5,500.2891,471.5,504.2891,481.5,508.2891,477.5,504.2891" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="475.5" x2="603.5" y1="504.2891" y2="504.2891"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="110" x="487.5" y="499.2231">Valid JWT payload</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="470.5" x2="512.5" y1="548.5547" y2="548.5547"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="512.5" x2="512.5" y1="548.5547" y2="561.5547"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="471.5" x2="512.5" y1="561.5547" y2="561.5547"/><polygon fill="#A80036" points="481.5,557.5547,471.5,561.5547,481.5,565.5547,477.5,561.5547" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="97" x="477.5" y="528.356">Validate claims</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="90" x="477.5" y="543.4888">(exp, iss, aud)</text><path d="M23,576.5547 L87,576.5547 L87,583.5547 L77,593.5547 L23,593.5547 L23,576.5547 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 1.0;"/><rect fill="none" height="105.3359" style="stroke: #000000; stroke-width: 2.0;" width="524" x="23" y="576.5547"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="19" x="38" y="589.6216">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="88" x="102" y="588.7651">[Claims valid]</text><polygon fill="#A80036" points="66.5,610.8203,56.5,614.8203,66.5,618.8203,62.5,614.8203" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="60.5" x2="469.5" y1="614.8203" y2="614.8203"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="151" x="72.5" y="609.7544">Response with resource</text><line style="stroke: #000000; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="23" x2="547" y1="623.8203" y2="623.8203"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="100" x="28" y="634.0308">[Claims invalid]</text><polygon fill="#A80036" points="66.5,669.8906,56.5,673.8906,66.5,677.8906,62.5,673.8906" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="60.5" x2="469.5" y1="673.8906" y2="673.8906"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="114" x="72.5" y="653.6919">401 Unauthorized</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="85" x="72.5" y="668.8247">Invalid claims</text><line style="stroke: #000000; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="13" x2="660" y1="689.8906" y2="689.8906"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="119" x="18" y="700.1011">[Signature invalid]</text><polygon fill="#A80036" points="481.5,720.8281,471.5,724.8281,481.5,728.8281,477.5,724.8281" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="475.5" x2="603.5" y1="724.8281" y2="724.8281"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="65" x="487.5" y="719.7622">Invalid JWT</text><polygon fill="#A80036" points="66.5,765.0938,56.5,769.0938,66.5,773.0938,62.5,769.0938" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="60.5" x2="469.5" y1="769.0938" y2="769.0938"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="114" x="72.5" y="748.895">401 Unauthorized</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="80" x="72.5" y="764.0278">Invalid token</text><rect fill="#EEEEEE" filter="url(#f16bhw1wh3arux)" height="3" style="stroke: #EEEEEE; stroke-width: 1.0;" width="770.5" x="3" y="804.6602"/><line style="stroke: #000000; stroke-width: 1.0;" x1="3" x2="773.5" y1="804.6602" y2="804.6602"/><line style="stroke: #000000; stroke-width: 1.0;" x1="3" x2="773.5" y1="807.6602" y2="807.6602"/><rect fill="#EEEEEE" filter="url(#f16bhw1wh3arux)" height="23.1328" style="stroke: #000000; stroke-width: 2.0;" width="278" x="249.25" y="794.0938"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="259" x="255.25" y="810.1606">Token Revocation Check (Optional)</text><polygon fill="#A80036" points="213.5,844.3594,203.5,848.3594,213.5,852.3594,209.5,848.3594" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="207.5" x2="469.5" y1="848.3594" y2="848.3594"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="244" x="219.5" y="843.2935">Check token blacklist (if implemented)</text><path d="M23,863.3594 L87,863.3594 L87,870.3594 L77,880.3594 L23,880.3594 L23,863.3594 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 1.0;"/><rect fill="none" height="163.6016" style="stroke: #000000; stroke-width: 2.0;" width="524" x="23" y="863.3594"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="19" x="38" y="876.4263">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="104" x="102" y="875.5698">[Token revoked]</text><polygon fill="#A80036" points="458.5,897.625,468.5,901.625,458.5,905.625,462.5,901.625" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="202.5" x2="464.5" y1="901.625" y2="901.625"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="107" x="209.5" y="896.5591">Token is revoked</text><polygon fill="#A80036" points="66.5,941.8906,56.5,945.8906,66.5,949.8906,62.5,945.8906" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="60.5" x2="469.5" y1="945.8906" y2="945.8906"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="114" x="72.5" y="925.6919">401 Unauthorized</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="94" x="72.5" y="940.8247">Revoked token</text><line style="stroke: #000000; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="23" x2="547" y1="954.8906" y2="954.8906"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="92" x="28" y="965.1011">[Token active]</text><polygon fill="#A80036" points="458.5,985.8281,468.5,989.8281,458.5,993.8281,462.5,989.8281" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="202.5" x2="464.5" y1="989.8281" y2="989.8281"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="85" x="209.5" y="984.7622">Token is valid</text><polygon fill="#A80036" points="66.5,1014.9609,56.5,1018.9609,66.5,1022.9609,62.5,1018.9609" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="60.5" x2="469.5" y1="1018.9609" y2="1018.9609"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="151" x="72.5" y="1013.895">Response with resource</text><rect fill="#EEEEEE" filter="url(#f16bhw1wh3arux)" height="3" style="stroke: #EEEEEE; stroke-width: 1.0;" width="770.5" x="3" y="1054.5273"/><line style="stroke: #000000; stroke-width: 1.0;" x1="3" x2="773.5" y1="1054.5273" y2="1054.5273"/><line style="stroke: #000000; stroke-width: 1.0;" x1="3" x2="773.5" y1="1057.5273" y2="1057.5273"/><rect fill="#EEEEEE" filter="url(#f16bhw1wh3arux)" height="23.1328" style="stroke: #000000; stroke-width: 2.0;" width="242" x="267.25" y="1043.9609"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="223" x="273.25" y="1060.0278">Public Key Rotation (Optional)</text><polygon fill="#A80036" points="213.5,1094.2266,203.5,1098.2266,213.5,1102.2266,209.5,1098.2266" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="207.5" x2="469.5" y1="1098.2266" y2="1098.2266"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="142" x="219.5" y="1093.1606">Fetch latest public key</text><polygon fill="#A80036" points="458.5,1123.3594,468.5,1127.3594,458.5,1131.3594,462.5,1127.3594" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="202.5" x2="464.5" y1="1127.3594" y2="1127.3594"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="122" x="209.5" y="1122.2935">Updated public key</text><!--MD5=[099e09d1565f57dc4ad1acd10d5ef9e2]
@startuml
skinparam linetype ortho

actor Client
participant "Auth Server" as AuthServer
participant "Resource Server" as ResourceServer
participant "JWT Library" as JWTLibrary

Client -> AuthServer: POST /authenticate\n(credentials)
AuthServer -> AuthServer: Validate credentials
AuthServer -> JWTLibrary: Generate JWT\n(header, payload, secret)
JWTLibrary -> AuthServer: JWT token
AuthServer -> Client: Response with JWT

== Token Validation on API Request ==

Client -> ResourceServer: GET /protected-resource\nAuthorization: Bearer <JWT>
ResourceServer -> JWTLibrary: Decode JWT
JWTLibrary -> JWTLibrary: Verify signature\n(using secret/public key)
alt Signature valid
    JWTLibrary -> ResourceServer: Valid JWT payload
    ResourceServer -> ResourceServer: Validate claims\n(exp, iss, aud)
    alt Claims valid
        ResourceServer -> Client: Response with resource
    else Claims invalid
        ResourceServer -> Client: 401 Unauthorized\nInvalid claims
    end
else Signature invalid
    JWTLibrary -> ResourceServer: Invalid JWT
    ResourceServer -> Client: 401 Unauthorized\nInvalid token
end

== Token Revocation Check (Optional) ==
ResourceServer -> AuthServer: Check token blacklist (if implemented)
alt Token revoked
    AuthServer -> ResourceServer: Token is revoked
    ResourceServer -> Client: 401 Unauthorized\nRevoked token
else Token active
    AuthServer -> ResourceServer: Token is valid
    ResourceServer -> Client: Response with resource
end

== Public Key Rotation (Optional) ==
ResourceServer -> AuthServer: Fetch latest public key
AuthServer -> ResourceServer: Updated public key

@enduml

PlantUML version 1.2020.02(Sun Mar 01 10:22:07 UTC 2020)
(GPL source distribution)
Java Runtime: OpenJDK Runtime Environment
JVM: OpenJDK 64-Bit Server VM
Java Version: 11.0.25+9
Operating System: Linux
Default Encoding: UTF-8
Language: en
Country: null
--></g></svg>